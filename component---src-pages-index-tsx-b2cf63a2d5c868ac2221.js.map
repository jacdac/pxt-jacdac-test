{"version":3,"file":"component---src-pages-index-tsx-b2cf63a2d5c868ac2221.js","mappings":"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","sources":["webpack://jacdac-docs/./node_modules/@mui/icons-material/Clear.js","webpack://jacdac-docs/./src/components/alert/ConnectAlert.tsx","webpack://jacdac-docs/./src/components/makecode/MakeCodeAddBlocksButton.tsx","webpack://jacdac-docs/./src/components/makecode/MakeCodeBlocksAndSimsBox.tsx","webpack://jacdac-docs/./src/jacdac/usePersistentSimulators.ts","webpack://jacdac-docs/./src/pages/index.tsx"],"sourcesContent":["\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\nvar _jsxRuntime = require(\"react/jsx-runtime\");\nvar _default = (0, _createSvgIcon.default)( /*#__PURE__*/(0, _jsxRuntime.jsx)(\"path\", {\n  d: \"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z\"\n}), 'Clear');\nexports.default = _default;","// tslint:disable-next-line: no-submodule-imports\nimport { Box } from \"@mui/material\"\n// tslint:disable-next-line: no-submodule-imports\nimport Alert from \"../ui/Alert\"\nimport React, { useContext } from \"react\"\nimport { serviceSpecificationFromClassIdentifier } from \"../../../jacdac-ts/src/jdom/spec\"\nimport JacdacContext, { JacdacContextProps } from \"../../jacdac/Context\"\nimport { NoSsr } from \"@mui/material\"\nimport ConnectButtons from \"../buttons/ConnectButtons\"\nimport useDevices from \"../hooks/useDevices\"\nimport { UIFlags } from \"../../jacdac/providerbus\"\n\nfunction NoSsrConnectAlert(props: {\n    serviceClass?: number\n    closeable?: boolean\n}) {\n    const { serviceClass, closeable } = props\n    const { bus } = useContext<JacdacContextProps>(JacdacContext)\n    const { transports } = bus\n    const devices = useDevices({ serviceClass, ignoreInfrastructure: true })\n    const spec = serviceSpecificationFromClassIdentifier(serviceClass)\n\n    // don't show if no transport, some devices\n    if ((!UIFlags.connect && !transports.length) || devices?.length) return null\n\n    return (\n        <Box displayPrint=\"none\">\n            <Alert severity=\"info\" closeable={closeable}>\n                {!spec && <span>Did you connect your device?</span>}\n                {spec && <span>Did you connect a {spec.name} device?</span>}\n                <Box component=\"span\" ml={2}>\n                    <ConnectButtons full=\"always\" transparent={true} />\n                </Box>\n            </Alert>\n        </Box>\n    )\n}\n\nexport default function ConnectAlert(props: {\n    serviceClass?: number\n    closeable?: boolean\n}) {\n    return (\n        <NoSsr>\n            <NoSsrConnectAlert {...props} />\n        </NoSsr>\n    )\n}\n","import Tooltip from \"../ui/Tooltip\"\nimport { Button } from \"gatsby-theme-material-ui\"\nimport React, { useMemo } from \"react\"\nimport useChange from \"../../jacdac/useChange\"\nimport IFrameBridgeClient from \"./iframebridgeclient\"\nimport MakeCodeIcon from \"../../components/icons/MakeCodeIcon\"\nimport useBus from \"../../jacdac/useBus\"\nimport { tL } from \"../translations\"\n\nexport default function MakeCodeAddBlocksButton() {\n    const bus = useBus()\n    const iframeBridge = bus.nodeData[\n        IFrameBridgeClient.DATA_ID\n    ] as IFrameBridgeClient\n    const extensions = useChange(iframeBridge, _ => _?.candidateExtensions())\n    const handleAdd = () => iframeBridge?.postAddExtensions()\n    const isButtonEnabled = !!extensions?.length\n\n    return (\n        <Tooltip\n            describeChild\n            title={tL(isButtonEnabled ? \"blockEnabled\" : \"blockDisabled\")}\n            placement=\"bottom\"\n        >\n            <span>\n                <Button\n                    sx={{ mr: 1 }}\n                    size=\"small\"\n                    color=\"primary\"\n                    variant=\"contained\"\n                    disabled={!isButtonEnabled}\n                    startIcon={<MakeCodeIcon />}\n                    onClick={handleAdd}\n                >\n                    {tL(\"blockAdd\")}\n                </Button>\n            </span>\n        </Tooltip>\n    )\n}\n","import { Box } from \"@mui/material\"\nimport React from \"react\"\nimport StartMissingSimulatorsButton from \"../buttons/StartMissingSimulatorsButton\"\nimport MakeCodeAddBlocksButton from \"./MakeCodeAddBlocksButton\"\nimport { tL } from \"../translations\"\n\nexport default function MakeCodeBlocksAndSimsBox() {\n\n  return (\n      <Box m={1}>\n        <MakeCodeAddBlocksButton />\n        <StartMissingSimulatorsButton\n        variant=\"contained\"\n        >\n          {tL(\"simAdd\")}\n        </StartMissingSimulatorsButton>\n      </Box>\n      )\n}\n","import { useEffect } from \"react\"\nimport {\n    DEVICE_CONNECT,\n    DEVICE_DISCONNECT,\n} from \"../../jacdac-ts/src/jdom/constants\"\nimport {\n    addServiceProvider,\n    serviceProviderDefinitions,\n} from \"../../jacdac-ts/src/servers/servers\"\nimport useLocalStorage from \"../components/hooks/useLocalStorage\"\nimport useBus from \"./useBus\"\n\nconst STORAGE_KEY = \"active_simulators\"\nconst STORAGE_EXPIRATION = 3600_000\n\ninterface Simulators {\n    update?: number\n    templates: string[]\n}\n\nexport function usePersistentSimulators() {\n    const [simulators, setSimulators] = useLocalStorage<Simulators>(\n        STORAGE_KEY,\n        undefined\n    )\n    const bus = useBus()\n    const resolveTemplates = () =>\n        bus\n            .serviceProviders()\n            .map(sp => sp.template)\n            .filter(t => !!t)\n\n    const snapshot = () => {\n        const templates = resolveTemplates()\n        setSimulators({\n            update: Date.now(),\n            templates,\n        })\n    }\n\n    useEffect(() => {\n        if ((simulators?.update || 0) - Date.now() < STORAGE_EXPIRATION) {\n            const serviceProviders = serviceProviderDefinitions()\n            const templates = resolveTemplates()\n            simulators?.templates?.forEach(template => {\n                const i = templates.indexOf(template)\n                if (i > -1) {\n                    templates.splice(i, 1)\n                } else {\n                    const def = serviceProviders.find(\n                        sp => sp.name === template\n                    )\n                    if (def) addServiceProvider(bus, def)\n                }\n            })\n        }\n        snapshot()\n    }, [])\n\n    useEffect(\n        () => bus.subscribe([DEVICE_CONNECT, DEVICE_DISCONNECT], snapshot),\n        [bus]\n    )\n}\n","import React, { useContext, useEffect } from \"react\"\nimport { createTheme, responsiveFontSizes } from \"@mui/material\"\nimport ThemedLayout from \"../components/ui/ThemedLayout\"\nimport { JDDevice } from \"../../jacdac-ts/src/jdom/device\"\nimport { isReading, isValueOrIntensity } from \"../../jacdac-ts/src/jdom/spec\"\nimport { strcmp } from \"../../jacdac-ts/src/jdom/utils\"\nimport Dashboard from \"../components/dashboard/Dashboard\"\nimport DarkModeContext from \"../components/ui/DarkModeContext\"\nimport IFrameBridgeClient from \"../components/makecode/iframebridgeclient\"\nimport useBus from \"../jacdac/useBus\"\nimport MakeCodeBlocksAndSimsBox from \"../components/makecode/MakeCodeBlocksAndSimsBox\"\nimport { usePersistentSimulators } from \"../jacdac/usePersistentSimulators\"\n\n/**\n * To debug locally:\n *\n * - launch yarn develop\n * - launch pxt serve + ?localhostmessagesims=1\n * - launch jacdac project\n */\n\nfunction deviceSort(l: JDDevice, r: JDDevice): number {\n    const srvScore = (srv: jdspec.ServiceSpec) =>\n        srv.packets.reduce(\n            (prev, pkt) =>\n                prev + (isReading(pkt) ? 10 : isValueOrIntensity(pkt) ? 1 : 0),\n            0\n        ) || 0\n    const score = (srvs: jdspec.ServiceSpec[]) =>\n        srvs.reduce((prev, srv) => srvScore(srv), 0)\n\n    const ls = score(\n        l\n            .services()\n            .slice(1)\n            .map(srv => srv.specification)\n            .filter(spec => !!spec)\n    )\n    const rs = score(\n        r\n            .services()\n            .slice(1)\n            .map(srv => srv.specification)\n            .filter(spec => !!spec)\n    )\n    if (ls !== rs) return -ls + rs\n    return strcmp(l.deviceId, r.deviceId)\n}\n\nfunction Carousel() {\n    const bus = useBus()\n    const iframeBridge = bus.nodeData[\n        IFrameBridgeClient.DATA_ID\n    ] as IFrameBridgeClient\n    const deviceFilter = iframeBridge?.deviceFilter.bind(iframeBridge)\n    const serviceFilter = iframeBridge?.serviceFilter.bind(iframeBridge)\n\n    useEffect(() => {\n        bus.streaming = true\n        bus.broadcastDisconnectRequest()\n    }, [])\n\n    usePersistentSimulators()\n\n    return (\n        <>\n            <MakeCodeBlocksAndSimsBox />\n            <Dashboard\n                showHeader={false}\n                showDeviceHeader={true}\n                showDeviceAvatar={true}\n                deviceSort={deviceSort}\n                deviceFilter={deviceFilter}\n                serviceFilter={serviceFilter}\n                showStartRoleSimulators={false}\n                alwaysVisible={true}\n                variant=\"icon\"\n                controlled={true}\n            />\n        </>\n    )\n}\n\nexport default function Page() {\n    const { toggleDarkMode, darkModeMounted } = useContext(DarkModeContext)\n    const rawTheme = createTheme({\n        palette: {\n            primary: {\n                main: \"#85e\",\n            },\n            secondary: {\n                main: \"#ffc400\",\n            },\n            background: {\n                default: \"#fff\",\n            },\n            mode: \"light\",\n            contrastThreshold: 3.1,\n        },\n    })\n    const theme = responsiveFontSizes(rawTheme)\n\n    useEffect(() => {\n        if (darkModeMounted) toggleDarkMode(\"light\")\n    }, [darkModeMounted])\n\n    return (\n        <ThemedLayout theme={theme}>\n                <style>\n                    {`\nhtml {\n    margin-right: 4px;\n}\nhtml, body {\n    background: transparent !important;\n    overflow: hidden !important;\n}\n`}\n                </style>\n            <Carousel />\n        </ThemedLayout>\n    )\n}\n"],"names":["useContext","devices","useDevices","ignoreInfrastructure","spec","serviceSpecificationFromClassIdentifier","UIFlags","transports","bus","useBus","iframeBridge","IFrameBridgeClient","extensions","useChange","_","handleAdd","isButtonEnabled","tL","mr","STORAGE_KEY","STORAGE_EXPIRATION","useLocalStorage","resolveTemplates","sp","t","snapshot","templates","setSimulators","update","Date","useEffect","serviceProviders","serviceProviderDefinitions","simulators","template","i","def","addServiceProvider","srvScore","srv","prev","isReading","isValueOrIntensity","score","srvs","ls","l","rs","r","strcmp","deviceFilter","serviceFilter","usePersistentSimulators","darkModeMounted","rawTheme","createTheme","palette","primary","main","secondary","background","default","mode","contrastThreshold","theme","responsiveFontSizes","toggleDarkMode"],"sourceRoot":""}